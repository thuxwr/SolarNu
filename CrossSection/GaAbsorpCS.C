/*
	Use "root GaAbsorpCS.C" to create "GaAbsorpCS.root" in data directory.

	This is the best-estimate nue absorption cross section of gallium.
	From http://www.sns.ias.edu/~jnb/Papers/Preprints/Gallium/paper.pdf	 

	Weiran, Aug 30, 2017

*/
#include <iostream>

using namespace std;

void GaAbsorpCS()
{
	double x[200], y[200],z[200],u[200],v[200];
	x[0]=0.24;x[1]=0.25;x[2]=0.275;x[3]=0.3;x[4]=0.325;x[5]=0.35;x[6]=0.375;x[7]=0.4;x[8]=0.425;x[9]=0.45;x[10]=0.5;
	x[11]=0.6;x[12]=0.7;x[13]=0.8;x[14]=0.9;x[15]=1;x[16]=1.1;x[17]=1.2;x[18]=1.3;x[19]=1.4;x[20]=1.5;x[21]=1.6;
	x[22]=1.7;x[23]=1.75;x[24]=2;x[25]=2.5;x[26]=3;x[27]=3.5;x[28]=4;x[29]=4.5;x[30]=5;x[31]=5.5;x[32]=6;x[33]=6.5;
	x[34]=7;x[35]=7.5;x[36]=8;x[37]=8.5;x[38]=9;x[39]=9.5;x[40]=10;x[41]=10.5;x[42]=11;x[43]=11.5;x[44]=12;x[45]=12.5;
	x[46]=13;x[47]=13.5;x[48]=14;x[49]=14.5;x[50]=15;x[51]=15.5;x[52]=16;x[53]=18;x[54]=20;

	//3-sigma high cross section
	y[0]=1.395e1;y[1]=1.446e1;y[2]=1.598e1;y[3]=1.772e1;y[4]=1.958e1;y[5]=2.153e1;y[6]=2.357e1;y[7]=2.567e1;y[8]=3.101e1;
	y[9]=3.362e1;y[10]=3.921e1;y[11]=5.154e1;y[12]=6.534e1;y[13]=8.261e1;y[14]=1.031e2;y[15]=1.258e2;y[16]=1.658e2;
	y[17]=1.996e2;y[18]=2.366e2;y[19]=2.768e2;y[20]=3.311e2;y[21]=3.829e2;y[22]=4.39e2;y[23]=4.685e2;y[24]=6.336e2;
	y[25]=1.073e3;y[26]=1.688e3;y[27]=2.559e3;y[28]=3.808e3;y[29]=5.609e3;y[30]=8.127e3;y[31]=1.153e4;y[32]=1.603e4;
	y[33]=2.194e4;y[34]=2.954e4;y[35]=3.9e4;y[36]=5.022e4;y[37]=6.316e4;y[38]=7.779e4;y[39]=9.422e4;y[40]=1.123e5;
	y[41]=1.321e5;y[42]=1.536e5;y[43]=1.766e5;y[44]=2.013e5;y[45]=2.275e5;y[46]=2.552e5;y[47]=2.845e5;y[48]=3.152e5;
	y[49]=3.474e5;y[50]=3.811e5;y[51]=4.161e5;y[52]=4.526e5;y[53]=6.117e5;y[54]=7.91e5;

	//3-sigma low cross section
	z[0]=1.224e1;z[1]=1.268e1;z[2]=1.4e1;z[3]=1.551e1;z[4]=1.714e1;z[5]=1.884e1;z[6]=2.06e1;z[7]=2.244e1;z[8]=2.465e1;
	z[9]=2.664e1;z[10]=3.083e1;z[11]=3.996e1;z[12]=5.011e1;z[13]=6.245e1;z[14]=7.505e1;z[15]=8.868e1;z[16]=1.076e2;
	z[17]=1.251e2;z[18]=1.439e2;z[19]=1.64e2;z[20]=1.882e2;z[21]=2.122e2;z[22]=2.378e2;z[23]=2.511e2;z[24]=3.162e2;
	z[25]=4.971e2;z[26]=7.318e2;z[27]=1.041e3;z[28]=1.456e3;z[29]=2.017e3;z[30]=2.766e3;z[31]=3.744e3;z[32]=5.001e3;
	z[33]=6.615e3;z[34]=8.658e3;z[35]=1.117e4;z[36]=1.412e4;z[37]=1.752e4;z[38]=2.136e4;z[39]=2.566e4;z[40]=3.04e4;
	z[41]=3.541e4;z[42]=4.082e4;z[43]=4.657e4;z[44]=5.264e4;z[45]=5.902e4;z[46]=6.568e4;z[47]=7.26e4;z[48]=7.973e4;
	z[49]=8.706e4;z[50]=9.455e4;z[51]=1.022e5;z[52]=1.098e5;z[53]=1.406e5;z[54]=1.689e5;

	//best-estimate cross section
	u[0]=1.31e1;u[1]=1.357e1;u[2]=1.499e1;u[3]=1.662e1;u[4]=1.836e1;u[5]=2.018e1;u[6]=2.208e1;u[7]=2.406e1;u[8]=2.648e1;
	u[9]=2.862e1;u[10]=3.314e1;u[11]=4.3e1;u[12]=5.397e1;u[13]=6.848e1;u[14]=8.276e1;u[15]=9.83e1;u[16]=1.226e2;
	u[17]=1.440e2;u[18]=1.672e2;u[19]=1.921e2;u[20]=2.243e2;u[21]=2.553e2;u[22]=2.886e2;u[23]=3.061e2;u[24]=3.972e2;
	u[25]=6.493e2;u[26]=9.905e2;u[27]=1.464e3;u[28]=2.129e3;u[29]=3.074e3;u[30]=4.38e3;u[31]=6.133e3;u[32]=8.434e3;
	u[33]=1.144e4;u[34]=1.530e4;u[35]=2.009e4;u[36]=2.576e4;u[37]=3.23e4;u[38]=3.968e4;u[39]=4.797e4;u[40]=5.71e4;
	u[41]=6.705e4;u[42]=7.781e4;u[43]=8.937e4;u[44]=1.017e5;u[45]=1.148e5;u[46]=1.287e5;u[47]=1.432e5;u[48]=1.585e5;
	u[49]=1.745e5;u[50]=1.912e5;u[51]=2.085e5;u[52]=2.264e5;u[53]=3.04e5;u[54]=3.899e5;

	//sigma at any energy bin, using average of high and low 3-sigma region, assuming gaussian distribution.
	int n = 55;
	for(int i=0; i<n; i++)
	{
		v[i] = (y[i]-z[i])/6.;
	}
	TGraph* cs = new TGraph(n,x,v);
	cs->SetTitle("Gallium Absorption Cross Section Error");
	cs->GetXaxis()->SetTitle("Energy/[MeV]");
	cs->GetYaxis()->SetTitle("Cross Section /[1e-46 cm^2]");
	cs->SetName("Error");
	//cs->Draw();
	TGraph* gr = new TGraph(n,x,u);
	gr->SetTitle("Gallium Absorption Cross Section");
	gr->GetXaxis()->SetTitle("Energy/[MeV]");
	gr->GetYaxis()->SetTitle("Cross Section /1e-46 cm^2");
	gr->SetName("CrossSection");

	TFile* file = new TFile("./data/GaAbsorpCS.root","RECREATE");
	gr->Write();
	cs->Write();

	gROOT->ProcessLine(".q");
}
